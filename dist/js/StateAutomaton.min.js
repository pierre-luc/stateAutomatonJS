/*!
 * StateAutomatonJS - v0.5.1
 * @author Pierre-Luc BLOT
 * @created 13/11/15
 */
!function(t){var e={pattern:{},graphic:{defaultContext:null,antialiasing:!0,getContext:function(t,e){if("undefined"==typeof t){if(null===this.defaultContext)throw"Aucun context n'a été initialisé";return this.defaultContext}"undefined"==typeof e&&(e=!0);var o=t.getContext("2d");return this.antialiasing&&e?(o.imageSmoothingEnabled=!0,o.lineWidth=1):(o.translate(.5,.5),o.imageSmoothingEnabled=!0,o.lineWidth=.5),null===this.defaultContext&&(this.defaultContext=o),o},setDefaultContext:function(t){this.defaultContext=t},createEnvironment:function(t,e){}}};"undefined"==typeof t.stateAutomaton&&(t.stateAutomaton=e)}(window),function(t){"use strict";var e=function(t){this.x=t.coord.x,this.y=t.coord.y,this.name=t.name};e.prototype.getCoord=function(){return{x:this.x,y:this.y}},e.prototype.setCoord=function(t){this.x=t.x,this.y=t.y},e.prototype.setName=function(t){this.name=t},e.prototype.draw=function(e){"undefined"==typeof e&&(e=t.stateAutomaton.graphic.defaultContext),e.beginPath(),e.moveTo(this.x-5,this.y),e.lineTo(this.x+5,this.y),e.moveTo(this.x,this.y-5),e.lineTo(this.x,this.y+5),e.lineWidth=1,e.stroke()},e.prototype.distance=function(t){return Math.sqrt((this.x-t.getCoord().x)*(this.x-t.getCoord().x)+(this.y-t.getCoord().y)*(this.y-t.getCoord().y))},t.stateAutomaton.graphic.Point=e}(window),function(t){"use strict";var e=function(t){this.row=t.row,this.col=t.col,this.width=t.width,this.height=t.height,this.colExtendCount=0,this.rowExtendCount=0,this.cell={width:this.width/this.col,height:this.height/this.row}};e.prototype.getSizeCell=function(){return this.cell},e.prototype.getRow=function(){return this.row},e.prototype.getCol=function(){return this.col},e.prototype.getHeight=function(){return this.height},e.prototype.getWidth=function(){return this.width},e.prototype.extendCol=function(t){if("undefined"==typeof t)throw"Un canvas doit être passé en paramètre";var e=stateAutomaton.graphic.getContext(t);e.save(),this.width+=this.cell.width,++this.col,++this.colExtendCount,t.width=this.width},e.prototype.extendRow=function(t){if("undefined"==typeof t)throw"Un canvas doit être passé en paramètre";var e=stateAutomaton.graphic.getContext(t);e.save(),this.height+=this.cell.height,++this.row,++this.rowExtendCount,t.height=this.height},e.prototype.getCellAt=function(t,e){function o(t,e,o){return new stateAutomaton.graphic.Point({coord:{x:t,y:e},name:o?o:""})}var i={top:{left:o(t*this.cell.width,e*this.cell.height),center:o((t*this.cell.width+(t+1)*this.cell.width)/2,e*this.cell.height),right:o((t+1)*this.cell.width,e*this.cell.height)},bottom:{left:o(t*this.cell.width,(e+1)*this.cell.height),center:o((t*this.cell.width+(t+1)*this.cell.width)/2,(e+1)*this.cell.height),right:o((t+1)*this.cell.width,(e+1)*this.cell.height)},middle:o((t*this.cell.width+(t+1)*this.cell.width)/2,(e*this.cell.height+(e+1)*this.cell.height)/2,"("+t+", "+e+")")};return i},e.prototype.getMatrix=function(){for(var t=[],e=0;e<this.col;++e){t[e]=[];for(var o=0;o<this.row;++o)t[e][o]=this.getCellAt(e,o)}return t},e.prototype.drawCell=function(e,o){"undefined"==typeof o&&(o=t.stateAutomaton.graphic.defaultContext),o.beginPath(),o.moveTo(e.top.left.getCoord().x,e.top.left.getCoord().y),o.lineTo(e.top.right.getCoord().x,e.top.right.getCoord().y),o.lineTo(e.bottom.right.getCoord().x,e.bottom.right.getCoord().y),o.lineTo(e.bottom.left.getCoord().x,e.bottom.left.getCoord().y),o.lineTo(e.top.left.getCoord().x,e.top.left.getCoord().y),o.stroke()},t.stateAutomaton.pattern.Grid=e}(window),function(t){"use strict";var e=function(t){"undefined"==typeof t&&(t={}),this.lineWidth=t.lineWidth?t.lineWidth:1,this.fillStyle=t.fillColor?t.fillColor:"white",this.strokeStyle=t.color?t.color:"black",this.font=t.font?t.font:"20px Helvetica",this.textAlign=t.textAlign?t.textAlign:"left",this.textBaseline=t.baseline?t.baseline:"top",this.lineStyle=t.lineStyle?t.lineStyle:"normal",this.context={},this.paramContext=["lineWidth","fillStyle","strokeStyle","textBaseline","textAlign","font"]};e.prototype.getTextAlign=function(){return this.textAlign},e.prototype.getBaseline=function(){return this.textBaseline},e.prototype.getFont=function(){return this.font},e.prototype.getLineWidth=function(){return this.lineWidth},e.prototype.getFillColor=function(){return this.fillStyle},e.prototype.getColor=function(){return this.strokeStyle},e.prototype.setTextAlign=function(t){this.textAlign=t},e.prototype.setBaseline=function(t){this.textBaseline=t},e.prototype.setFont=function(t){this.font=t},e.prototype.setLineWidth=function(t){this.lineWidth=t},e.prototype.setFillColor=function(t){this.fillStyle=t},e.prototype.setColor=function(t){this.strokeStyle=t},e.prototype.apply=function(t){var e,o;for(e in this.paramContext)o=this.paramContext[e],this.context[o]=t[o];this.context.lineStyle=t.getLineDash();for(e in this.paramContext)o=this.paramContext[e],t[o]=this[o];switch(this.lineStyle){case"dashed":t.setLineDash([5,15]);break;case"normal":t.setLineDash([]);break;default:t.setLineDash([])}},e.prototype.restore=function(t){for(var e in this.paramContext){var o=this.paramContext[e];t[o]=this.context[o]}t.setLineDash(this.context.lineStyle)},t.stateAutomaton.graphic.Style=e}(window),function(t){"use strict";var e=function(t){this.start=t.start,this.end=t.end,o(this),this.middle=new stateAutomaton.graphic.Point({coord:{x:(this.start.getCoord().x+this.end.getCoord().x)/2,y:(this.start.getCoord().y+this.end.getCoord().y)/2}}),this.norm=this.start.distance(this.end),this.style=t.style?t.style:new stateAutomaton.graphic.Style},o=function(t){t.start.getCoord().x==t.end.getCoord().x?t.angle=Math.PI/2:t.start.getCoord().y==t.end.getCoord().y?t.angle=0:t.angle=Math.atan((t.end.getCoord().y-t.start.getCoord().y)/(t.end.getCoord().x-t.start.getCoord().x))};e.prototype.getStyle=function(){return this.style},e.prototype.setStyle=function(t){this.style=t},e.prototype.getStartPoint=function(){return this.start},e.prototype.getEndPoint=function(){return this.end},e.prototype.draw=function(e){"undefined"==typeof e&&(e=t.stateAutomaton.graphic.defaultContext),e.beginPath(),this.style.apply(e),e.moveTo(this.start.getCoord().x,this.start.getCoord().y),e.lineTo(this.end.getCoord().x,this.end.getCoord().y),e.stroke(),this.style.restore(e)},e.prototype.getAngle=function(){return o(this),this.angle},e.prototype.getMiddle=function(){return this.middle},e.prototype.getNorm=function(){return this.norm},e.prototype.getVector=function(){return{x:this.end.getCoord().x-this.start.getCoord().x,y:this.end.getCoord().y-this.start.getCoord().y}},t.stateAutomaton.graphic.Line=e}(window),function(t){"use strict";var e=function(t){this.start=t.start,this.end=t.end,this.height=t.height,this.style=t.style?t.style:new stateAutomaton.graphic.Style,o(this)},o=function(t){var e=new stateAutomaton.graphic.Line({start:t.start,end:t.end});t.control1=new stateAutomaton.graphic.Point({coord:{x:t.start.getCoord().x+t.height*Math.cos(e.getAngle()+Math.PI/2+Math.PI/11),y:t.start.getCoord().y+t.height*Math.sin(e.getAngle()+Math.PI/2+Math.PI/11)}}),t.control2=new stateAutomaton.graphic.Point({coord:{x:t.end.getCoord().x+t.height*Math.cos(e.getAngle()+Math.PI/2-Math.PI/11),y:t.end.getCoord().y+t.height*Math.sin(e.getAngle()+Math.PI/2-Math.PI/11)}}),t.middleControl=new stateAutomaton.graphic.Point({coord:{x:(t.control1.getCoord().x+t.control2.getCoord().x)/2,y:(t.control1.getCoord().y+t.control2.getCoord().y)/2}})};e.prototype.getHeight=function(){return this.height},e.prototype.setHeight=function(t){this.height=t,o(this)},e.prototype.getMiddleControlPoint=function(){return o(this),this.middleControl},e.prototype.getStartControlPoint=function(){return o(this),this.control1},e.prototype.getEndControlPoint=function(){return o(this),this.control2},e.prototype.getStartPoint=function(){return this.start},e.prototype.getEndPoint=function(){return this.end},e.prototype.draw=function(e){"undefined"==typeof e&&(e=t.stateAutomaton.graphic.defaultContext),e.beginPath(),this.style.apply(e),e.moveTo(this.start.getCoord().x,this.start.getCoord().y),e.bezierCurveTo(this.control1.getCoord().x,this.control1.getCoord().y,this.control2.getCoord().x,this.control2.getCoord().y,this.end.getCoord().x,this.end.getCoord().y),e.stroke(),this.style.restore(e)},t.stateAutomaton.graphic.Arc=e}(window),function(t){"use strict";var e=function(t){this.origin=t.origin,this.angle=t.angle,this.style=t.style?t.style:new stateAutomaton.graphic.Style,this.style.setFillColor(this.style.getColor()),this.height=t.height+this.style.getLineWidth(),this.width=t.width+this.style.getLineWidth()};e.prototype.getStyle=function(){return this.style},e.prototype.getOrigin=function(){return this.origin},e.prototype.getHeight=function(){return this.height-this.style.getLineWidth()+1},e.prototype.getWidth=function(){return this.width-this.style.getLineWidth()+1},e.prototype.draw=function(e){"undefined"==typeof e&&(e=t.stateAutomaton.graphic.defaultContext);var o={x:this.origin.getCoord().x,y:this.origin.getCoord().y};e.lineWidth;this.style.apply(e),e.beginPath(),e.save(),e.translate(o.x,o.y),e.rotate(this.angle),e.moveTo(-this.width,0),e.lineTo(-this.width,-this.height),e.lineTo(0,0),e.lineTo(-this.width,this.height),e.lineTo(-this.width,0),e.closePath(),e.fill(),e.restore(),this.style.restore(e)},t.stateAutomaton.graphic.HeadArrow=e}(window),function(t){"use strict";var e=function(t){function e(t,e,o,i,n){var r=t*t,s=r*t;return e+(3*-e+t*(3*e-e*t))*t+(3*o+t*(-6*o+3*o*t))*t+(3*i-3*i*t)*r+n*s}function o(t,o,i,n,r){var s=e(r,t.x,o.x,i.x,n.x),h=e(r,t.y,o.y,i.y,n.y);return{x:s,y:h}}function i(t,e){var i,n,r,s,h,a=.1;"end"==e?(n={x:t.sx,y:t.sy},r={x:t.ex,y:t.ey},s=r,h=.99-a):(n={x:t.sx,y:t.sy},r={x:t.ex,y:t.ey},s=n,h=.01+a),i=o(n,{x:t.cx1,y:t.cy1},{x:t.cx2,y:t.cy2},r,h);var d=s.x-i.x,l=s.y-i.y;return Math.atan2(l,d)}this.style=t.style?t.style:new stateAutomaton.graphic.Style,t.style=this.style,this.arc=new stateAutomaton.graphic.Arc(t);var n={sx:this.arc.getStartPoint().getCoord().x,sy:this.arc.getStartPoint().getCoord().y,cx1:this.arc.getStartControlPoint().getCoord().x,cy1:this.arc.getStartControlPoint().getCoord().y,cx2:this.arc.getEndControlPoint().getCoord().x,cy2:this.arc.getEndControlPoint().getCoord().y,ex:this.arc.getEndPoint().getCoord().x,ey:this.arc.getEndPoint().getCoord().y};this.arrowRight=new stateAutomaton.graphic.HeadArrow({origin:this.arc.getEndPoint(),height:5,width:5,angle:i(n,"end"),style:this.style}),this.arrowLeft=new stateAutomaton.graphic.HeadArrow({origin:this.arc.getStartPoint(),height:5,width:5,angle:i(n,"start"),style:this.style}),this.direction="right","string"==typeof t.direction&&(this.direction=t.direction)};e.prototype.getDirection=function(){return this.direction},e.prototype.getArc=function(){return this.arc},e.prototype.draw=function(e){"undefined"==typeof e&&(e=t.stateAutomaton.graphic.defaultContext),this.arc.draw(e),("left"==this.direction||"both"==this.direction)&&this.arrowLeft.draw(e),("right"==this.direction||"both"==this.direction)&&this.arrowRight.draw(e)},t.stateAutomaton.graphic.ArcArrow=e}(window),function(t){"use strict";var e=function(t){this.start=t.start,this.end=t.end,this.style=t.style?t.style:new stateAutomaton.graphic.Style,this.direction="right","string"==typeof t.direction&&(this.direction=t.direction),o(this)},o=function(t){var e=0,o=0,i=0,n=0,r=new stateAutomaton.graphic.Line({start:t.start,end:t.end}).getAngle(),s=new stateAutomaton.graphic.Point({coord:{x:t.start.getCoord().x+e,y:t.start.getCoord().y+o}}),h=new stateAutomaton.graphic.Point({coord:{x:t.end.getCoord().x+i,y:t.end.getCoord().y+n}});t.line=new stateAutomaton.graphic.Line({start:s,end:h,style:t.style});var a=r,d=r+Math.PI,l=t.line.getVector();l.x>0&&l.y<0&&(a=r+Math.PI,d=r),l.x>0&&l.y>0&&(a=r+Math.PI,d=r),t.endHeadArrow=new stateAutomaton.graphic.HeadArrow({origin:t.start,angle:a,height:5,width:5,style:t.style}),t.startHeadArrow=new stateAutomaton.graphic.HeadArrow({origin:t.end,angle:d,height:5,width:5,style:t.style})};e.prototype.getStartPoint=function(){return this.start},e.prototype.getEndPoint=function(){return this.end},e.prototype.getDirection=function(){return this.direction},e.prototype.draw=function(e){"undefined"==typeof e&&(e=t.stateAutomaton.graphic.defaultContext),o(this),this.line.draw(e),("right"==this.direction||"both"==this.direction)&&this.endHeadArrow.draw(e),("left"==this.direction||"both"==this.direction)&&this.startHeadArrow.draw(e)},t.stateAutomaton.graphic.Arrow=e}(window),function(t){"use strict";var e=function(t){this.center=t.center,this.pointRadius=null;t.radius;"number"!=typeof t.radius?this.setPointRadius(t.point):this.setRadius(t.radius)};e.prototype.getCenter=function(){return this.center},e.prototype.getRadius=function(){return this.radius},e.prototype.setCenter=function(t){this.center=t},e.prototype.updateCenter=function(t){this.center.setCoord(t.getCoord()),null!==this.pointRadius&&this.setPointRadius(this.pointRadius)},e.prototype.setRadius=function(t){this.radius=t},e.prototype.setPointRadius=function(t){this.pointRadius=t,this.radius=this.center.distance(t)},e.prototype.draw=function(e){"undefined"==typeof e&&(e=t.stateAutomaton.graphic.defaultContext),e.beginPath(),e.arc(this.center.getCoord().x,this.center.getCoord().y,this.radius,0,2*Math.PI,!0),e.stroke()},e.prototype.getPoint=function(t){return new stateAutomaton.graphic.Point({coord:{x:this.center.getCoord().x+this.radius*Math.cos(t),y:this.center.getCoord().y+this.radius*Math.sin(t)}})},t.stateAutomaton.graphic.Circle=e}(window),function(t){"use strict";var e=function(t,e){if("undefined"==typeof t)throw"Un canvas est nécessaire pour construire un environnement graphique.";this.canvas=t,this.context=stateAutomaton.graphic.getContext(t,e),this.elementsCount=0,this.elements={}};e.prototype.getWidth=function(){return this.canvas.width},e.prototype.getHeight=function(){return this.canvas.width},e.prototype.addElement=function(t,e){"undefined"==typeof this.elements[t]&&(this.elements[t]=e,++this.elementsCount)},e.prototype.addElements=function(t){for(var e in t)this.addElement(e,t[e])},e.prototype.getElement=function(t){return this.elements[t]},e.prototype.getContext=function(){return this.context},e.prototype.clear=function(){this.elements=[],this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.redraw=function(){this.context.save(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.draw(),this.context.restore()},e.prototype.draw=function(){for(var t in this.elements)this.elements[t].draw(this.context)},e.prototype.getImage=function(){var t=new Image;return t.src=this.canvas.toDataUrl(),t},t.stateAutomaton.graphic.createEnvironment=function(t,e){return new stateAutomaton.graphic.Environment(t,e)},t.stateAutomaton.graphic.Environment=e}(window),function(t){"use strict";var e=function(t){this.text=t.text,this.point=t.point,this.style=t.style?t.style:new stateAutomaton.graphic.Style,this.font=this.style.getFont(),this.textAlign=this.style.getTextAlign(),this.textBaseline=this.style.getBaseline(),this.fillColor=this.style.getFillColor()};e.prototype.getStyle=function(){return this.style},e.prototype.getText=function(){return this.text},e.prototype.getPoint=function(){return this.point},e.prototype.getTextPxLength=function(t){if("undefined"==typeof t)throw"Le context du canvas doit être définit.";return t.measureText(this.text)},e.prototype.draw=function(e){"undefined"==typeof e&&(e=t.stateAutomaton.graphic.defaultContext),e.beginPath(),this.style.apply(e),e.fillText(this.text,this.point.getCoord().x,this.point.getCoord().y),e.stroke(),this.style.restore(e)},t.stateAutomaton.graphic.Text=e}(window);